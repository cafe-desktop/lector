#!/bin/bash

#script to test CVE-2023-51698
#See https://www.cve.org/CVERecord?id=CVE-2023-51698

if [ -f "/tmp/covfefe.evince" ]; then
    rm /tmp/covfefe.evince
fi

if [ -f "sample.cbt" ]; then
    killall lector
    lector sample.cbt
else
    echo && echo error: sample.cbt is missing && echo
    exit 1
fi

if [ -f "/tmp/covfefe.evince" ]; then
    echo && echo WARNING: lector is vulnerable! && echo
    rm /tmp/covfefe.evince
else
    echo && echo lector is ok! && echo
fi
